<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INHBE-DIO Metabolic Study Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.27.0/plotly.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .main-content {
            display: flex;
            flex-direction: row;
            flex: 1;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .header p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .controls {
            background: #f8f9fa;
            padding: 25px;
            border-right: 2px solid #e0e0e0;
            width: 400px;
            flex-shrink: 0;
            overflow-y: auto;
            max-height: calc(100vh - 140px);
        }
        
        .control-section {
            margin-bottom: 25px;
        }
        
        .control-section h3 {
            font-size: 15px;
            color: #2c3e50;
            margin-bottom: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .metric-selector {
            width: 100%;
            padding: 12px 15px;
            font-size: 14px;
            border: 2px solid #ddd;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .metric-selector:hover {
            border-color: #667eea;
        }
        
        .metric-selector:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .group-controls {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        
        .group-control-item {
            background: white;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .group-control-item:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .group-name-input {
            width: 100%;
            padding: 8px 10px;
            font-size: 13px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
            transition: all 0.3s;
        }
        
        .group-name-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
        }
        
        .color-shape-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .color-picker {
            width: 50px;
            height: 35px;
            border: 2px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .color-picker:hover {
            border-color: #667eea;
        }
        
        .shape-selector {
            flex: 1;
            padding: 8px 10px;
            font-size: 13px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .shape-selector:hover {
            border-color: #667eea;
        }
        
        .slider-control {
            margin-bottom: 15px;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 13px;
            color: #2c3e50;
            font-weight: 500;
        }
        
        .slider-value {
            color: #667eea;
            font-weight: 600;
        }
        
        .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e0e0e0;
            outline: none;
            -webkit-appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .slider::-webkit-slider-thumb:hover {
            background: #5568d3;
            transform: scale(1.2);
        }
        
        .slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }
        
        .axis-controls {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .axis-control-group {
            background: white;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
        }
        
        .axis-control-group h4 {
            font-size: 13px;
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .axis-inputs {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .axis-input {
            flex: 1;
            padding: 8px 10px;
            font-size: 13px;
            border: 1px solid #ddd;
            border-radius: 4px;
            transition: all 0.3s;
        }
        
        .axis-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
        }
        
        .axis-buttons {
            display: flex;
            gap: 8px;
        }
        
        .btn {
            padding: 8px 16px;
            font-size: 13px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
            flex: 1;
        }
        
        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .btn-secondary {
            background: #e0e0e0;
            color: #2c3e50;
            flex: 1;
        }
        
        .btn-secondary:hover {
            background: #d0d0d0;
        }
        
        .plot-container {
            padding: 30px;
            background: white;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        #chart {
            width: 100%;
            flex: 1;
            min-height: 600px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .controls {
                width: 100%;
                max-height: none;
                border-right: none;
                border-bottom: 2px solid #e0e0e0;
            }
            
            .group-controls {
                grid-template-columns: 1fr;
            }
            
            .axis-controls {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß¨ INHBE-DIO Metabolic Study Dashboard</h1>
            <p>Interactive visualization of mouse metabolic data with customizable views</p>
        </div>
        
        <div class="main-content">
            <div class="controls">
                <div class="control-section">
                    <h3>üìä Select Metric</h3>
                    <select id="metricSelector" class="metric-selector">
                        <option value="Body weight (g)">Body weight (g)</option>
                        <option value="Body weight change (%)">Body weight change (%)</option>
                        <option value="Food intake/day/mouse (g)">Food intake/day/mouse (g)</option>
                        <option value="Water intake/day/mouse (g)">Water intake/day/mouse (g)</option>
                        <option value="Fat mass (g)">Fat mass (g)</option>
                        <option value="Lean mass (g)">Lean mass (g)</option>
                        <option value="Fat mass/BW (%)">Fat mass/BW (%)</option>
                        <option value="Lean mass/BW (%)">Lean mass/BW (%)</option>
                        <option value="Fat mass change (%)">Fat mass change (%)</option>
                        <option value="Lean mass change (%)">Lean mass change (%)</option>
                    </select>
                </div>
                
                <div class="control-section">
                    <h3>üé® Group Customization</h3>
                    <div id="groupControls" class="group-controls"></div>
                </div>
                
                <div class="control-section">
                    <h3>üìè Line & Marker Settings</h3>
                    <div class="slider-control">
                        <div class="slider-label">
                            <span>Line Width</span>
                            <span class="slider-value" id="lineWidthValue">2.00px</span>
                        </div>
                        <input type="range" id="lineWidthSlider" class="slider" 
                               min="0.5" max="6" step="0.25" value="2">
                    </div>
                    <div class="slider-control">
                        <div class="slider-label">
                            <span>Marker Size</span>
                            <span class="slider-value" id="markerSizeValue">7px</span>
                        </div>
                        <input type="range" id="markerSizeSlider" class="slider" 
                               min="3" max="20" step="1" value="7">
                    </div>
                </div>
                
                <div class="control-section">
                    <h3>üéØ Axis Range Controls</h3>
                    <div class="axis-controls">
                        <div class="axis-control-group">
                            <h4>X-Axis (Days)</h4>
                            <div class="axis-inputs">
                                <input type="number" id="xMin" class="axis-input" placeholder="Min (Auto)">
                                <input type="number" id="xMax" class="axis-input" placeholder="Max (Auto)">
                            </div>
                            <div class="axis-buttons">
                                <button id="applyXRange" class="btn btn-primary">Apply</button>
                                <button id="resetXRange" class="btn btn-secondary">Reset</button>
                            </div>
                        </div>
                        <div class="axis-control-group">
                            <h4>Y-Axis</h4>
                            <div class="axis-inputs">
                                <input type="number" id="yMin" class="axis-input" placeholder="Min (Auto)">
                                <input type="number" id="yMax" class="axis-input" placeholder="Max (Auto)">
                            </div>
                            <div class="axis-buttons">
                                <button id="applyYRange" class="btn btn-primary">Apply</button>
                                <button id="resetYRange" class="btn btn-secondary">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="plot-container">
                <div id="chart">
                    <div style="padding: 60px; text-align: center; color: #667eea;">
                        <h3>üìä Loading dashboard...</h3>
                        <p>If this message persists, check the browser console for errors.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Embedded data
        const allData = {
        "Body weight (g)": {
                "Group 10: 25 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                53.22,
                                48.48333333,
                                46.55
                        ],
                        "sems": [
                                1.4,
                                1.345465636,
                                1.72
                        ]
                },
                "Group 11: STD": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                35.44,
                                36.18,
                                35.44
                        ],
                        "sems": [
                                0.64,
                                0.780640762,
                                0.82
                        ]
                },
                "Group 1: HFD": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                52.55,
                                52.7875,
                                53.09
                        ],
                        "sems": [
                                0.8,
                                0.638479639,
                                0.67
                        ]
                },
                "Group 2: 25 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                52.88,
                                53.13333333,
                                53.22
                        ],
                        "sems": [
                                0.66,
                                0.797356744,
                                0.65
                        ]
                },
                "Group 3: 0.12 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                52.82,
                                47.91666667,
                                45.15
                        ],
                        "sems": [
                                1.17,
                                1.187831825,
                                0.42
                        ]
                },
                "Group 4: 0.04 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                53.0,
                                48.03333333,
                                46.13
                        ],
                        "sems": [
                                0.59,
                                1.090157991,
                                1.68
                        ]
                },
                "Group 5: 9 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                52.73,
                                53.01666667,
                                52.75
                        ],
                        "sems": [
                                0.86,
                                0.771758454,
                                0.64
                        ]
                },
                "Group 6: 25 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                52.52,
                                52.93333333,
                                53.23
                        ],
                        "sems": [
                                0.93,
                                0.978661217,
                                0.92
                        ]
                },
                "Group 7: 0.04 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                53.07,
                                48.05,
                                44.88
                        ],
                        "sems": [
                                0.58,
                                0.508428953,
                                0.86
                        ]
                },
                "Group 8: 0.04 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                52.68,
                                48.03333333,
                                45.42
                        ],
                        "sems": [
                                0.73,
                                0.422426851,
                                0.47
                        ]
                },
                "Group 9: 25 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                51.93,
                                51.85,
                                51.9
                        ],
                        "sems": [
                                1.09,
                                1.088959748,
                                1.05
                        ]
                }
        },
        "Fat mass (g)": {
                "Group 10: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                20.38,
                                16.01
                        ],
                        "sems": [
                                0.87,
                                1.24
                        ]
                },
                "Group 11: STD": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                2.2,
                                2.34
                        ],
                        "sems": [
                                1.21,
                                1.42
                        ]
                },
                "Group 1: HFD": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                20.63,
                                21.23
                        ],
                        "sems": [
                                0.41,
                                0.35
                        ]
                },
                "Group 2: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                20.45,
                                20.96
                        ],
                        "sems": [
                                0.33,
                                0.34
                        ]
                },
                "Group 3: 0.12 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                20.3,
                                15.91
                        ],
                        "sems": [
                                0.93,
                                0.51
                        ]
                },
                "Group 4: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                19.65,
                                16.13
                        ],
                        "sems": [
                                0.14,
                                0.78
                        ]
                },
                "Group 5: 9 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                20.48,
                                20.2
                        ],
                        "sems": [
                                0.46,
                                0.5
                        ]
                },
                "Group 6: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                19.68,
                                20.32
                        ],
                        "sems": [
                                0.86,
                                0.94
                        ]
                },
                "Group 7: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                19.74,
                                14.6
                        ],
                        "sems": [
                                0.64,
                                1.0
                        ]
                },
                "Group 8: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                19.91,
                                15.53
                        ],
                        "sems": [
                                0.33,
                                0.56
                        ]
                },
                "Group 9: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                19.87,
                                19.28
                        ],
                        "sems": [
                                0.6,
                                0.6
                        ]
                }
        },
        "Lean mass (g)": {
                "Group 10: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                30.32,
                                28.85
                        ],
                        "sems": [
                                0.42,
                                0.5
                        ]
                },
                "Group 11: STD": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                32.1,
                                32.19
                        ],
                        "sems": [
                                1.0,
                                0.93
                        ]
                },
                "Group 1: HFD": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                29.47,
                                29.38
                        ],
                        "sems": [
                                0.43,
                                0.37
                        ]
                },
                "Group 2: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                30.17,
                                29.73
                        ],
                        "sems": [
                                0.64,
                                0.67
                        ]
                },
                "Group 3: 0.12 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                30.37,
                                27.53
                        ],
                        "sems": [
                                0.31,
                                0.31
                        ]
                },
                "Group 4: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                30.7,
                                28.29
                        ],
                        "sems": [
                                0.53,
                                0.73
                        ]
                },
                "Group 5: 9 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                29.98,
                                29.97
                        ],
                        "sems": [
                                0.52,
                                0.47
                        ]
                },
                "Group 6: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                30.44,
                                30.55
                        ],
                        "sems": [
                                0.47,
                                0.44
                        ]
                },
                "Group 7: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                31.02,
                                28.75
                        ],
                        "sems": [
                                0.76,
                                0.59
                        ]
                },
                "Group 8: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                30.45,
                                28.22
                        ],
                        "sems": [
                                0.49,
                                0.21
                        ]
                },
                "Group 9: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                29.75,
                                30.39
                        ],
                        "sems": [
                                0.55,
                                0.43
                        ]
                }
        },
        "Fat mass/BW (%)": {
                "Group 10: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                38.23,
                                34.14
                        ],
                        "sems": [
                                0.81,
                                1.54
                        ]
                },
                "Group 11: STD": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                6.13,
                                6.33
                        ],
                        "sems": [
                                3.27,
                                3.67
                        ]
                },
                "Group 1: HFD": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                39.26,
                                39.99
                        ],
                        "sems": [
                                0.49,
                                0.43
                        ]
                },
                "Group 2: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                38.69,
                                39.42
                        ],
                        "sems": [
                                0.76,
                                0.81
                        ]
                },
                "Group 3: 0.12 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                38.35,
                                35.2
                        ],
                        "sems": [
                                1.0,
                                0.88
                        ]
                },
                "Group 4: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                37.09,
                                34.88
                        ],
                        "sems": [
                                0.45,
                                0.54
                        ]
                },
                "Group 5: 9 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                38.84,
                                38.3
                        ],
                        "sems": [
                                0.58,
                                0.8
                        ]
                },
                "Group 6: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                37.4,
                                38.09
                        ],
                        "sems": [
                                1.09,
                                1.22
                        ]
                },
                "Group 7: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                37.21,
                                32.42
                        ],
                        "sems": [
                                1.28,
                                1.77
                        ]
                },
                "Group 8: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                37.8,
                                34.15
                        ],
                        "sems": [
                                0.47,
                                0.9
                        ]
                },
                "Group 9: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                38.23,
                                37.12
                        ],
                        "sems": [
                                0.56,
                                0.62
                        ]
                }
        },
        "Lean mass/BW (%)": {
                "Group 10: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                57.09,
                                62.27
                        ],
                        "sems": [
                                1.08,
                                1.8
                        ]
                },
                "Group 11: STD": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                90.69,
                                91.09
                        ],
                        "sems": [
                                3.09,
                                3.68
                        ]
                },
                "Group 1: HFD": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                56.08,
                                55.35
                        ],
                        "sems": [
                                0.42,
                                0.46
                        ]
                },
                "Group 2: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                57.03,
                                55.84
                        ],
                        "sems": [
                                0.76,
                                0.69
                        ]
                },
                "Group 3: 0.12 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                57.62,
                                61.01
                        ],
                        "sems": [
                                1.13,
                                0.96
                        ]
                },
                "Group 4: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                57.9,
                                61.45
                        ],
                        "sems": [
                                0.47,
                                0.83
                        ]
                },
                "Group 5: 9 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                56.86,
                                56.81
                        ],
                        "sems": [
                                0.72,
                                0.51
                        ]
                },
                "Group 6: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                58.05,
                                57.49
                        ],
                        "sems": [
                                1.33,
                                1.32
                        ]
                },
                "Group 7: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                58.43,
                                64.17
                        ],
                        "sems": [
                                1.11,
                                1.7
                        ]
                },
                "Group 8: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                57.81,
                                62.17
                        ],
                        "sems": [
                                0.56,
                                0.95
                        ]
                },
                "Group 9: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                57.32,
                                58.61
                        ],
                        "sems": [
                                0.65,
                                0.74
                        ]
                }
        },
        "Fat mass change (%)": {
                "Group 10: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -22.03
                        ],
                        "sems": [
                                0.0,
                                3.06
                        ]
                },
                "Group 11: STD": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                0.45
                        ],
                        "sems": [
                                0.0,
                                11.29
                        ]
                },
                "Group 1: HFD": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                2.96
                        ],
                        "sems": [
                                0.0,
                                1.17
                        ]
                },
                "Group 2: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                2.53
                        ],
                        "sems": [
                                0.0,
                                0.56
                        ]
                },
                "Group 3: 0.12 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -21.35
                        ],
                        "sems": [
                                0.0,
                                1.66
                        ]
                },
                "Group 4: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -17.92
                        ],
                        "sems": [
                                0.0,
                                3.9
                        ]
                },
                "Group 5: 9 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -1.35
                        ],
                        "sems": [
                                0.0,
                                1.02
                        ]
                },
                "Group 6: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                3.23
                        ],
                        "sems": [
                                0.0,
                                1.01
                        ]
                },
                "Group 7: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -26.36
                        ],
                        "sems": [
                                0.0,
                                3.13
                        ]
                },
                "Group 8: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -21.96
                        ],
                        "sems": [
                                0.0,
                                2.7
                        ]
                },
                "Group 9: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -2.97
                        ],
                        "sems": [
                                0.0,
                                0.53
                        ]
                }
        },
        "Lean mass change (%)": {
                "Group 10: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -4.87
                        ],
                        "sems": [
                                0.0,
                                0.45
                        ]
                },
                "Group 11: STD": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                0.3
                        ],
                        "sems": [
                                0.0,
                                0.31
                        ]
                },
                "Group 1: HFD": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -0.26
                        ],
                        "sems": [
                                0.0,
                                0.72
                        ]
                },
                "Group 2: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -1.46
                        ],
                        "sems": [
                                0.0,
                                0.33
                        ]
                },
                "Group 3: 0.12 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -9.31
                        ],
                        "sems": [
                                0.0,
                                1.24
                        ]
                },
                "Group 4: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -7.91
                        ],
                        "sems": [
                                0.0,
                                0.9
                        ]
                },
                "Group 5: 9 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                0.0
                        ],
                        "sems": [
                                0.0,
                                0.63
                        ]
                },
                "Group 6: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                0.38
                        ],
                        "sems": [
                                0.0,
                                0.29
                        ]
                },
                "Group 7: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -7.22
                        ],
                        "sems": [
                                0.0,
                                1.12
                        ]
                },
                "Group 8: 0.04 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                -7.27
                        ],
                        "sems": [
                                0.0,
                                1.04
                        ]
                },
                "Group 9: 25 mg/kg": {
                        "days": [
                                -1,
                                6
                        ],
                        "means": [
                                0.0,
                                2.18
                        ],
                        "sems": [
                                0.0,
                                0.51
                        ]
                }
        },
        "Food intake/day/mouse (g)": {
                "Group 10: 25 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                2.744444444,
                                0.81,
                                1.53
                        ],
                        "sems": [
                                0.066341801,
                                0.04,
                                0.06
                        ]
                },
                "Group 11: STD": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                3.76,
                                4.4,
                                3.38
                        ],
                        "sems": [
                                0.038809443,
                                0.08,
                                0.12
                        ]
                },
                "Group 1: HFD": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                2.554166667,
                                2.5,
                                2.75
                        ],
                        "sems": [
                                0.046761878,
                                0.13,
                                0.07
                        ]
                },
                "Group 2: 25 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                2.655555556,
                                2.58,
                                2.71
                        ],
                        "sems": [
                                0.084947333,
                                0.12,
                                0.08
                        ]
                },
                "Group 3: 0.12 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                2.594444444,
                                0.72,
                                1.32
                        ],
                        "sems": [
                                0.054715877,
                                0.03,
                                0.04
                        ]
                },
                "Group 4: 0.04 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                3.005555556,
                                0.83,
                                1.63
                        ],
                        "sems": [
                                0.114557657,
                                0.18,
                                0.21
                        ]
                },
                "Group 5: 9 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                2.655555556,
                                2.62,
                                2.41
                        ],
                        "sems": [
                                0.0,
                                0.0,
                                0.0
                        ]
                },
                "Group 6: 25 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                2.916666667,
                                2.9,
                                2.96
                        ],
                        "sems": [
                                0.052469862,
                                0.06,
                                0.06
                        ]
                },
                "Group 7: 0.04 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                2.833333333,
                                0.77,
                                1.14
                        ],
                        "sems": [
                                0.081989159,
                                0.08,
                                0.04
                        ]
                },
                "Group 8: 0.04 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                3.005555556,
                                0.76,
                                1.37
                        ],
                        "sems": [
                                0.096128772,
                                0.1,
                                0.17
                        ]
                },
                "Group 9: 25 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                2.577777778,
                                2.38,
                                2.48
                        ],
                        "sems": [
                                0.221345493,
                                0.07,
                                0.13
                        ]
                }
        },
        "Water intake/day/mouse (g)": {
                "Group 10: 25 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                5.522222222,
                                2.57,
                                3.07
                        ],
                        "sems": [
                                0.329496436,
                                0.29,
                                0.18
                        ]
                },
                "Group 11: STD": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                6.28,
                                7.54,
                                7.52
                        ],
                        "sems": [
                                0.740290233,
                                1.67,
                                1.6
                        ]
                },
                "Group 1: HFD": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                3.6875,
                                5.26,
                                3.41
                        ],
                        "sems": [
                                0.460863327,
                                0.24,
                                0.17
                        ]
                },
                "Group 2: 25 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                4.716666667,
                                5.25,
                                7.33
                        ],
                        "sems": [
                                0.314642654,
                                1.1,
                                2.21
                        ]
                },
                "Group 3: 0.12 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                3.85,
                                2.86,
                                2.35
                        ],
                        "sems": [
                                0.679746685,
                                0.99,
                                0.15
                        ]
                },
                "Group 4: 0.04 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                5.044444444,
                                4.15,
                                2.78
                        ],
                        "sems": [
                                0.304341021,
                                0.72,
                                0.32
                        ]
                },
                "Group 5: 9 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                4.316666667,
                                3.22,
                                3.91
                        ],
                        "sems": [
                                0.140765105,
                                0.12,
                                0.63
                        ]
                },
                "Group 6: 25 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                6.094444444,
                                5.13,
                                4.54
                        ],
                        "sems": [
                                0.310007965,
                                1.15,
                                0.53
                        ]
                },
                "Group 7: 0.04 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                5.066666667,
                                3.83,
                                2.66
                        ],
                        "sems": [
                                0.790780205,
                                0.51,
                                0.08
                        ]
                },
                "Group 8: 0.04 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                5.066666667,
                                3.69,
                                3.77
                        ],
                        "sems": [
                                0.55429301,
                                0.67,
                                0.83
                        ]
                },
                "Group 9: 25 mg/kg": {
                        "days": [
                                0,
                                3,
                                6
                        ],
                        "means": [
                                4.366666667,
                                4.72,
                                4.22
                        ],
                        "sems": [
                                0.577013383,
                                1.19,
                                0.92
                        ]
                }
        },
        "Body weight change (%)": {
                "Group 10: 25 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                0.0,
                                -8.900162852311158,
                                -12.532882375046977
                        ],
                        "sems": [
                                2.6305900037579857,
                                2.528120323186772,
                                3.231867718902668
                        ]
                },
                "Group 11: STD": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                0.0,
                                2.0880361173814954,
                                0.0
                        ],
                        "sems": [
                                1.8058690744920995,
                                2.202710953724605,
                                2.3137697516930023
                        ]
                },
                "Group 1: HFD": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                0.0,
                                0.45195052331114033,
                                1.0275927687916389
                        ],
                        "sems": [
                                1.5223596574690772,
                                1.2149945556612751,
                                1.2749762131303521
                        ]
                },
                "Group 2: 25 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                0.0,
                                0.4790721066565746,
                                0.642965204235999
                        ],
                        "sems": [
                                1.248108925869894,
                                1.5078607110438729,
                                1.2291981845688351
                        ]
                },
                "Group 3: 0.12 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                0.0,
                                -9.28309982961,
                                -14.521014767133664
                        ],
                        "sems": [
                                2.2150700492237787,
                                2.24882965732677,
                                0.7951533510034078
                        ]
                },
                "Group 4: 0.04 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                0.0,
                                -9.37106918867925,
                                -12.962264150943392
                        ],
                        "sems": [
                                1.1132075471698113,
                                2.056901869811321,
                                3.1698113207547167
                        ]
                },
                "Group 5: 9 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                0.0,
                                0.5436500474113455,
                                0.03792907263418002
                        ],
                        "sems": [
                                1.630950123269486,
                                1.4636041228901953,
                                1.213730324293571
                        ]
                },
                "Group 6: 25 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                0.0,
                                0.7870017707539991,
                                1.35186595582634
                        ],
                        "sems": [
                                1.7707539984767706,
                                1.8634067345773035,
                                1.7517136329017517
                        ]
                },
                "Group 7: 0.04 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                0.0,
                                -9.459204823817604,
                                -15.43244771057094
                        ],
                        "sems": [
                                1.092896174863388,
                                0.9580345826267194,
                                1.620501224797437
                        ]
                },
                "Group 8: 0.04 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                0.0,
                                -8.820551765375857,
                                -13.781321184510247
                        ],
                        "sems": [
                                1.3857251328777525,
                                0.8018732934700077,
                                0.8921791951404707
                        ]
                },
                "Group 9: 25 mg/kg": {
                        "days": [
                                -1,
                                3,
                                6
                        ],
                        "means": [
                                0.0,
                                -0.15405353360292373,
                                -0.05777007510109982
                        ],
                        "sems": [
                                2.0989793953398808,
                                2.0969762141344117,
                                2.021952628538417
                        ]
                }
        }
};
        
        const groupList = ["Group 10: 25 mg/kg", "Group 11: STD", "Group 1: HFD", "Group 2: 25 mg/kg", "Group 3: 0.12 mg/kg", "Group 4: 0.04 mg/kg", "Group 5: 9 mg/kg", "Group 6: 25 mg/kg", "Group 7: 0.04 mg/kg", "Group 8: 0.04 mg/kg", "Group 9: 25 mg/kg"];
        
        const defaultColors = {"Group 10: 25 mg/kg": "#1f77b4", "Group 11: STD": "#ff7f0e", "Group 1: HFD": "#2ca02c", "Group 2: 25 mg/kg": "#d62728", "Group 3: 0.12 mg/kg": "#9467bd", "Group 4: 0.04 mg/kg": "#8c564b", "Group 5: 9 mg/kg": "#e377c2", "Group 6: 25 mg/kg": "#7f7f7f", "Group 7: 0.04 mg/kg": "#bcbd22", "Group 8: 0.04 mg/kg": "#17becf", "Group 9: 25 mg/kg": "#aec7e8"};
        
        const markerShapes = ["circle", "square", "diamond", "cross", "x", "triangle-up", "triangle-down", "star", "hexagon", "pentagon"];
        
        // Debug logging
        console.log('Data loaded successfully');
        console.log('Number of groups:', groupList.length);
        console.log('Metrics available:', Object.keys(allData));
        console.log('First group data sample:', allData['Body weight (g)'][groupList[0]]);
        
        // Current state
        const currentState = {
            metric: 'Body weight (g)',
            groupColors: {...defaultColors},
            groupNames: {},
            groupShapes: {},
            groupLineWidths: {},
            lineWidth: 2.0,
            markerSize: 7,
            xRange: null,
            yRange: null,
            visibilityState: {}
        };
        
        // Initialize group names and shapes
        groupList.forEach((group, idx) => {
            currentState.groupNames[group] = group;
            currentState.groupShapes[group] = 'circle';
            currentState.groupLineWidths[group] = 2.0;
            currentState.visibilityState[group] = true;
        });
        
        // Create group controls
        function createGroupControls() {
            const container = document.getElementById('groupControls');
            container.innerHTML = '';
            
            groupList.forEach((group, idx) => {
                const div = document.createElement('div');
                div.className = 'group-control-item';
                div.innerHTML = `
                    <input type="text" 
                           class="group-name-input" 
                           data-group="${group}" 
                           value="${group}"
                           placeholder="Group name">
                    <div class="color-shape-row">
                        <input type="color" 
                               class="color-picker" 
                               data-group="${group}" 
                               value="${defaultColors[group]}">
                        <select class="shape-selector" data-group="${group}">
                            ${markerShapes.map(shape => 
                                `<option value="${shape}">${shape}</option>`
                            ).join('')}
                        </select>
                    </div>
                    <div class="slider-control" style="margin-top: 10px;">
                        <div class="slider-label">
                            <span>Line Width</span>
                            <span class="slider-value group-linewidth-value" data-group="${group}">2.00px</span>
                        </div>
                        <input type="range" 
                               class="slider group-linewidth-slider" 
                               data-group="${group}"
                               min="0.5" 
                               max="8" 
                               step="0.25" 
                               value="2.0">
                    </div>
                `;
                container.appendChild(div);
            });
            
            // Add event listeners
            document.querySelectorAll('.group-name-input').forEach(input => {
                input.addEventListener('change', updateGroupName);
            });
            
            document.querySelectorAll('.color-picker').forEach(picker => {
                picker.addEventListener('change', updateGroupColor);
            });
            
            document.querySelectorAll('.shape-selector').forEach(selector => {
                selector.addEventListener('change', updateGroupShape);
            });
            
            document.querySelectorAll('.group-linewidth-slider').forEach(slider => {
                slider.addEventListener('input', updateGroupLineWidth);
            });
        }
        
        // Update group name
        function updateGroupName(event) {
            const group = event.target.dataset.group;
            const newName = event.target.value;
            currentState.groupNames[group] = newName;
            updatePlot();
        }
        
        // Update group color
        function updateGroupColor(event) {
            const group = event.target.dataset.group;
            const newColor = event.target.value;
            currentState.groupColors[group] = newColor;
            
            const traceIndex = groupList.indexOf(group);
            if (traceIndex !== -1) {
                const update = {
                    'line.color': [newColor],
                    'marker.color': [newColor],
                    'error_y.color': [newColor],
                    'line.width': [currentState.lineWidth]
                };
                Plotly.restyle('chart', update, [traceIndex]);
            }
        }
        
        // Update group shape
        function updateGroupShape(event) {
            const group = event.target.dataset.group;
            const newShape = event.target.value;
            currentState.groupShapes[group] = newShape;
            
            const traceIndex = groupList.indexOf(group);
            if (traceIndex !== -1) {
                Plotly.restyle('chart', {'marker.symbol': [newShape]}, [traceIndex]);
            }
        }
        
        // Update individual group line width
        function updateGroupLineWidth(event) {
            const group = event.target.dataset.group;
            const newWidth = parseFloat(event.target.value);
            currentState.groupLineWidths[group] = newWidth;
            
            // Update the displayed value
            const valueDisplay = document.querySelector(`.group-linewidth-value[data-group="${group}"]`);
            if (valueDisplay) {
                valueDisplay.textContent = newWidth.toFixed(2) + 'px';
            }
            
            // Update the trace
            const traceIndex = groupList.indexOf(group);
            if (traceIndex !== -1) {
                Plotly.restyle('chart', {'line.width': [newWidth]}, [traceIndex]);
            }
        }
        
        // Update line width (global - updates all groups)
        document.getElementById('lineWidthSlider').addEventListener('input', function() {
            const width = parseFloat(this.value);
            currentState.lineWidth = width;
            document.getElementById('lineWidthValue').textContent = width.toFixed(2) + 'px';
            
            // Update all group line widths
            groupList.forEach(group => {
                currentState.groupLineWidths[group] = width;
            });
            
            // Update all traces
            const update = {'line.width': Array(groupList.length).fill(width)};
            Plotly.restyle('chart', update);
            
            // Update all individual slider displays
            document.querySelectorAll('.group-linewidth-slider').forEach(slider => {
                slider.value = width;
            });
            document.querySelectorAll('.group-linewidth-value').forEach(value => {
                value.textContent = width.toFixed(2) + 'px';
            });
        });
        
        // Update marker size
        document.getElementById('markerSizeSlider').addEventListener('input', function() {
            const size = parseInt(this.value);
            currentState.markerSize = size;
            document.getElementById('markerSizeValue').textContent = size + 'px';
            
            const update = {'marker.size': Array(groupList.length).fill(size)};
            Plotly.restyle('chart', update);
        });
        
        // Create plot
        function createPlot() {
            try {
                console.log('Creating plot for metric:', currentState.metric);
                const metric = currentState.metric;
                const data = allData[metric];
                
                if (!data) {
                    console.error('No data found for metric:', metric);
                    return;
                }
                
                console.log('Processing', groupList.length, 'groups');
                
                const traces = groupList.map(group => {
                const groupData = data[group] || {days: [], means: [], sems: []};
                
                return {
                    x: groupData.days,
                    y: groupData.means,
                    error_y: {
                        type: 'data',
                        array: groupData.sems,
                        visible: true,
                        color: currentState.groupColors[group],
                        thickness: 1.5,
                        width: 4
                    },
                    mode: 'lines+markers',
                    name: currentState.groupNames[group],
                    line: {
                        color: currentState.groupColors[group],
                        width: currentState.groupLineWidths[group]
                    },
                    marker: {
                        size: currentState.markerSize,
                        color: currentState.groupColors[group],
                        symbol: currentState.groupShapes[group]
                    },
                    connectgaps: false,
                    visible: currentState.visibilityState[group],
                    hovertemplate: '<b>%{fullData.name}</b><br>' +
                                   'Day %{x}<br>' +
                                   'Mean: %{y:.2f}<br>' +
                                   'SEM: ¬±%{error_y.array:.2f}<extra></extra>'
                };
            });
            
            const layout = {
                title: {
                    text: metric,
                    font: {
                        size: 20,
                        color: '#2c3e50',
                        family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
                    }
                },
                xaxis: {
                    title: {
                        text: 'Day',
                        font: {size: 14, color: '#2c3e50'}
                    },
                    gridcolor: '#e0e0e0',
                    zeroline: true,
                    zerolinecolor: '#bdbdbd',
                    zerolinewidth: 2,
                    range: currentState.xRange
                },
                yaxis: {
                    title: {
                        text: metric,
                        font: {size: 14, color: '#2c3e50'}
                    },
                    gridcolor: '#e0e0e0',
                    zeroline: true,
                    zerolinecolor: '#bdbdbd',
                    zerolinewidth: 2,
                    range: currentState.yRange
                },
                plot_bgcolor: '#ffffff',
                paper_bgcolor: '#ffffff',
                hovermode: 'closest',
                legend: {
                    x: 1.02,
                    y: 1,
                    xanchor: 'left',
                    bgcolor: 'rgba(255,255,255,0.9)',
                    bordercolor: '#e0e0e0',
                    borderwidth: 1,
                    font: {size: 11}
                },
                margin: {
                    l: 80,
                    r: 220,
                    t: 60,
                    b: 60
                },
                autosize: true,
                height: null,
                font: {
                    family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
                }
            };
            
            const config = {
                responsive: true,
                displayModeBar: true,
                toImageButtonOptions: {
                    format: 'png',
                    filename: `INHBE_DIO_${metric.replace(/[^a-zA-Z0-9]/g, '_')}`,
                    height: 800,
                    width: 1400,
                    scale: 2
                }
            };
            
            Plotly.newPlot('chart', traces, layout, config);
            
            console.log('Plot created successfully with', traces.length, 'traces');
            
            // Save visibility state when legend is clicked
            const chartDiv = document.getElementById('chart');
            chartDiv.on('plotly_restyle', function(data) {
                if (data[0].visible !== undefined) {
                    const chartElement = document.getElementById('chart');
                    chartElement.data.forEach((trace, idx) => {
                        if (trace.visible !== undefined) {
                            currentState.visibilityState[groupList[idx]] = trace.visible;
                        }
                    });
                }
            });
            } catch (error) {
                console.error('Error creating plot:', error);
                document.getElementById('chart').innerHTML = '<div style="padding: 40px; text-align: center; color: #d62728;"><h3>Error creating plot</h3><p>' + error.message + '</p></div>';
            }
        }
        
        // Update plot for metric change
        function updatePlot() {
            createPlot();
        }
        
        // Metric selector
        document.getElementById('metricSelector').addEventListener('change', function() {
            currentState.metric = this.value;
            updatePlot();
        });
        
        // Axis controls
        document.getElementById('applyXRange').addEventListener('click', function() {
            const min = parseFloat(document.getElementById('xMin').value);
            const max = parseFloat(document.getElementById('xMax').value);
            if (!isNaN(min) && !isNaN(max)) {
                currentState.xRange = [min, max];
                Plotly.relayout('chart', {'xaxis.range': [min, max]});
            }
        });
        
        document.getElementById('resetXRange').addEventListener('click', function() {
            currentState.xRange = null;
            document.getElementById('xMin').value = '';
            document.getElementById('xMax').value = '';
            Plotly.relayout('chart', {'xaxis.autorange': true});
        });
        
        document.getElementById('applyYRange').addEventListener('click', function() {
            const min = parseFloat(document.getElementById('yMin').value);
            const max = parseFloat(document.getElementById('yMax').value);
            if (!isNaN(min) && !isNaN(max)) {
                currentState.yRange = [min, max];
                Plotly.relayout('chart', {'yaxis.range': [min, max]});
            }
        });
        
        document.getElementById('resetYRange').addEventListener('click', function() {
            currentState.yRange = null;
            document.getElementById('yMin').value = '';
            document.getElementById('yMax').value = '';
            Plotly.relayout('chart', {'yaxis.autorange': true});
        });
        
        // Initialize
        window.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing dashboard...');
            
            if (typeof Plotly === 'undefined') {
                console.error('Plotly failed to load!');
                document.getElementById('chart').innerHTML = 
                    '<div style="padding: 40px; text-align: center; color: #d62728;">' +
                    '<h3>‚ö†Ô∏è Error: Plotly library failed to load</h3>' +
                    '<p>Please check your internet connection and try opening the file again.</p>' +
                    '</div>';
                return;
            }
            
            console.log('Plotly loaded successfully');
            createGroupControls();
            createPlot();
        });
    </script>
</body>
</html>
